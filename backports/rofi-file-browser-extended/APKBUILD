# Contributor: Jakub Jirutka <jakub@jirutka.cz>
# Maintainer: Jakub Jirutka <jakub@jirutka.cz>
pkgname=rofi-file-browser-extended
pkgver=1.3.0
pkgrel=0
pkgdesc="Use rofi to quickly open files"
url="https://github.com/marvinkreis/rofi-file-browser-extended"
arch="all !riscv64 !s390x"  # blocked by rofi -> librsvg -> rust
license="MIT"
depends="cmd:rofi"
makedepends="cmake rofi-dev"
subpackages="$pkgname-doc"
source="https://github.com/marvinkreis/rofi-file-browser-extended/archive/$pkgver/rofi-file-browser-extended-$pkgver.tar.gz
	musl-compat.patch
	"
options="!check"  # no tests provided

build() {
	local crossopts=
	if [ "$CBUILD" != "$CHOST" ]; then
		crossopts="-DCMAKE_SYSTEM_NAME=Linux -DCMAKE_HOST_SYSTEM_NAME=Linux"
	fi
	cmake -B build \
		-DCMAKE_BUILD_TYPE=MinSizeRel \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_VERBOSE_MAKEFILE=ON \
		$crossopts .
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
8d41c4f0750e2196b52448529c0ded99afb8c443cc817778b6e8924674111e83a580861206ce62a58e4ddb091f93ff835cc9f27e7ee3fe9a4496c5afc050201a  rofi-file-browser-extended-1.3.0.tar.gz
bb1005d35496bde8351e98ba3ac4501aaac1eb25a8f2fcecd55189f085416affc330ea14f8dcd3c6a864d767793699584f3308ee44b48103d63d55438f5411bf  musl-compat.patch
"

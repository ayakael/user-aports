# Contributor: Jakub Jirutka <jakub@jirutka.cz>
# Maintainer: Jakub Jirutka <jakub@jirutka.cz>
pkgname=avizo
pkgver=1.0_git20220108
_gitrev=976db521c15f5b141c6ca733c80ab35c22a72731
pkgrel=0
pkgdesc="A neat notification daemon"
url="https://github.com/misterdanb/avizo"
arch="all"
license="GPL-3.0"
makedepends="
	gobject-introspection-dev
	gtk+3.0-dev
	gtk-layer-shell-dev
	meson
	vala
	"
source="https://github.com/misterdanb/avizo/archive/$_gitrev/$pkgname-$_gitrev.tar.gz
	pr-23.patch
	unbundle-images.patch
	lightctl
	volumectl
	"
subpackages="$pkgname-scripts::noarch"
builddir="$srcdir/$pkgname-$_gitrev"
options="!check"  # no tests provided

build() {
	abuild-meson . output
	meson compile ${JOBS:+-j ${JOBS}} -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output

	# Replace provided scripts with ours.
	# TODO: Remove after https://github.com/misterdanb/avizo/pull/24 is merged.
	install -D -m755 "$srcdir"/lightctl -t "$pkgdir"/usr/bin/
	install -D -m755 "$srcdir"/volumectl -t "$pkgdir"/usr/bin/
}

scripts() {
	pkgdesc="Scripts to control sound volume and display backlight integrated with Avizo"
	depends="$pkgname brightnessctl pamixer"

	amove usr/bin/lightctl
	amove usr/bin/volumectl
}

sha512sums="
0f019e1db0d316952d74475c75574e593d994a034abf7c78b8a1ae7a2ddb14131f5fb45bbe9e5160e58212d98ad438e57ddebd2c36d039bc59c862b19e612bbb  avizo-976db521c15f5b141c6ca733c80ab35c22a72731.tar.gz
916f26d6f94dbffe69006f695d262a9d053443860c3e85422e1ee648cab33bac346045c5c9e45f2858418d224b8e175c422854a36b28f97ea7a7b60356a76243  pr-23.patch
a42195eeb15e2ca2596c28904b6e23d6956a270939ffc972190756220e77be93a9006faacba0340d45dbb26e29fcdb622b89e8ea4bae341957262d6320eed24c  unbundle-images.patch
3d0346cb7aae785226e85243a6d9a0c71da6e23b7cfd3196b83faabae019a06b827f2b4f27f4d8fce4c5a5c9cb7def54dde5f57cb0d032b2c534e5522cb3faa6  lightctl
5d447f2a2ac2169af3e829200eae8dd3c3747d2fd80c1f3ba5b8953e4b31ec38405522756445378e2dbf9955f42d93f5e71a40c84dcf6427195429604ba2ff7d  volumectl
"
